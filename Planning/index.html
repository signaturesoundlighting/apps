<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signature Sound & Lighting - Wedding Planner</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="onboarding.css">
    <script>
        // Route iTunes API calls through Cloudflare Worker (mobile-safe)
        window.ITUNES_PROXY_URL = 'https://raspy-bush-7067.peakleadsgroup.workers.dev';
        
        // Configure Payment Intent API endpoint
        // TODO: Replace with your actual Cloudflare Worker URL after deployment
        // Example: 'https://stripe-payment-intent.your-account.workers.dev'
        // See STRIPE_SETUP.md for deployment instructions
        window.PAYMENT_INTENT_API_URL = null; // Set this after deploying the Cloudflare Worker
    </script>
</head>
<body>
    <div class="header">
        <img src="https://images.squarespace-cdn.com/content/v1/64909a307fc0025a2064d878/9b8fde02-b8f9-402b-be4c-366cb48134eb/Transparent+PNG+File.png" alt="Signature Sound & Lighting">
        <div class="couple-name" style="visibility: hidden;">&nbsp;</div>
        <div class="wedding-date" style="visibility: hidden;">&nbsp;</div>
        <div id="overallProgress" class="progress-container" aria-label="Form completion progress">
            <div class="progress-track"><div id="overallProgressBar" class="progress-bar" style="width:0%"></div></div>
            <div id="overallProgressText" class="progress-text">0/0 <svg viewBox="0 0 24 24" style="width: 14px; height: 14px; fill: #1a9e8e; vertical-align: middle;"><path d="M12 2a10 10 0 100 20 10 10 0 000-20zm1 15h-2v-2h2v2zm2-7.5c0 1.54-1 2.14-1.8 2.6-.72.41-1.2.69-1.2 1.4V14h-2v-.7c0-1.5 1-2.1 1.8-2.6.72-.41 1.2-.69 1.2-1.4 0-.83-.67-1.5-1.5-1.5S9 7.47 9 8.3H7c0-2 1.8-3.3 4-3.3s4 1.35 4 3.5z"/></svg> — 0%<br><span style="font-weight: normal;">Finalization required in 338 days</span></div>
        </div>
    </div>

    <div class="general-info-section">
        <h2 class="section-title">General Info</h2>
        <div class="general-info-card" onclick="openGeneralInfo()">
            <div style="font-size: 18px; font-weight: 600; color: #000;">Event Details</div>
        </div>
    </div>

    <h2 class="section-title">Event Timeline</h2>

    <div class="event-list" id="eventList"></div>

    <button class="add-event-btn" onclick="addCustomEvent()">+</button>

    <div class="save-indicator" id="saveIndicator">Changes saved ✓</div>

    <div class="modal" id="eventModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Event Details</h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <div class="add-event-modal" id="addEventModal">
        <div class="add-event-modal-content">
            <h2>Add New Event</h2>
            <div class="add-event-options" id="addEventOptions">
                <div class="add-event-option" onclick="showStandardEvents()">
                    <h3>Standard Event</h3>
                    <p>Choose from our pre-built event templates</p>
                </div>
                <div class="add-event-option" onclick="createCustomEvent()">
                    <h3>Custom Event</h3>
                    <p>Create a completely custom event</p>
                </div>
            </div>
            <div class="standard-events-list" id="standardEventsList">
                <button class="back-btn" onclick="backToAddOptions()">← Back</button>
                <div id="standardEventsContainer"></div>
            </div>
        </div>
    </div>

    <div class="song-search-modal" id="songSearchModal">
        <div class="song-search-content">
            <div class="song-search-header">
                <h3>Search for a Song</h3>
                <button class="close-btn" onclick="closeSongSearch()">&times;</button>
            </div>
            <div class="song-search-body">
                <div class="search-input-wrapper">
                    <input type="text" id="songSearchInput" placeholder="Search by song title or artist..." />
                    <button onclick="searchSongsWithPreview()">Search</button>
                </div>
                <div id="songSearchResults"></div>
            </div>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div class="modal" id="confirmModal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Confirm</h2>
                <button class="close-btn" onclick="closeConfirm()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="confirmMessage" style="font-size:16px; color:#333;">Are you sure?</div>
            </div>
            <div class="modal-footer">
                <button class="nav-btn" type="button" onclick="closeConfirm()">Cancel</button>
                <button class="nav-btn" type="button" id="confirmYesBtn">Yes</button>
            </div>
        </div>
    </div>

    <!-- Stripe.js -->
    <script src="https://js.stripe.com/v3/"></script>
    
    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Load scripts in order -->
    <script src="supabaseConfig.js"></script>
    <script src="supabaseHelpers.js"></script>
    <script src="data.js"></script>
    <script src="helpers.js"></script>
    <script src="ui.js"></script>
    <script src="modalContent.js"></script>
    <script src="modal.js"></script>
    <script src="drag.js"></script>
    <script src="songs.js"></script>
    <script src="events.js"></script>
    <script src="serviceAgreement.js"></script>
    <script src="depositPayment.js"></script>
    <script src="onboarding.js"></script>
    <script src="main.js"></script>
</body>
</html>
